# Change Log of `langium`

## v0.2.0 (Nov. 2021)

### Cross-File Linking

Cross-references can now be resolved between files. This works by introducing an _indexing_ phase where exported symbols are gathered from each document and made available in the _global scope_ ([#172](https://github.com/langium/langium/pull/172)). The default implementation exports the top-level AST elements that have a `name` property (the elements directly contained by the root of the AST), but this can be customized. The `ScopeProvider` service used to resolve cross-references first looks into locally defined symbols (from the same document), and falls back to the global scope when there is no local matching symbol.

The language server listens for file changes and updates documents and their exported symbols whenever a modification is reported by the client ([#271](https://github.com/langium/langium/pull/271), [#278](https://github.com/langium/langium/pull/278)).

### Asynchronous Processing

All LSP message processing is now potentially asynchronous, which enables longer-running operations to be cancelled ([#244](https://github.com/langium/langium/pull/244), [#269](https://github.com/langium/langium/pull/269)). This works by calling the utility function `interruptAndCheck`, which uses [`setImmediate`](https://nodejs.org/docs/latest-v15.x/api/timers.html#timers_setimmediate_callback_args) to interrupt the current execution so other incoming messages can be processed, and throws the `OperationCanceled` symbol when cancellation is indicated.

This is particularly important for the `DocumentBuilder` service, which is used to update documents and the index when change notifications are received. Cancellation ensures that the language server does not do unnecessary work when the user is modifying a document in a large workspace.

### Interpreted Parser

The parser is no longer generated by `langium-cli`, but constructed in-memory when the Langium application starts ([#169](https://github.com/langium/langium/pull/169)). This works by interpreting the grammar and building the parser via [Chevrotain](https://chevrotain.io/docs/)'s API. As a result, the whole infrastructure could be greatly simplified and now allows more fine-grained control over the lexing and parsing steps.

### Further Improvements

 * Introduced a testing API that enables unit tests for LSP features of your language ([#179](https://github.com/langium/langium/pull/179)).
 * Added API and default implementation for more LSP features:
    * [Folding](https://microsoft.github.io/language-server-protocol/specifications/specification-current/#textDocument_foldingRange) ([#178](https://github.com/langium/langium/pull/178))
    * [Hover](https://microsoft.github.io/language-server-protocol/specifications/specification-current/#textDocument_hover) ([#182](https://github.com/langium/langium/pull/182))
    * [Code actions](https://microsoft.github.io/language-server-protocol/specifications/specification-current/#textDocument_codeAction) ([#190](https://github.com/langium/langium/pull/190))
    * [Renaming](https://microsoft.github.io/language-server-protocol/specifications/specification-current/#textDocument_rename) ([#191](https://github.com/langium/langium/pull/191))
 * Terminal rules for comments are automatically detected and considered in syntax highlighting and other features ([#247](https://github.com/langium/langium/pull/247)).
 * You can now override the default linking of cross-references and generate custom error messages ([#256](https://github.com/langium/langium/pull/256), [#274](https://github.com/langium/langium/pull/274)), for example to realize function overloading.

### Breaking Changes

 * The API for generating code was improved ([#122](https://github.com/langium/langium/pull/122)).
 * The `GrammarAccess` service was removed because it was used mainly by the discontinued generated parser ([#169](https://github.com/langium/langium/pull/169)).
 * We now use the URI object from `vscode-uri` instead of plain strings ([#221](https://github.com/langium/langium/pull/221)).
 * Enhanced `Stream` API and removed `ArrayLikeStream` ([#257](https://github.com/langium/langium/pull/257)).
